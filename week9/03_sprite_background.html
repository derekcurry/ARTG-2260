<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>4 direction Sprite</title>
<style>
canvas { border:1px solid black; }
</style>
<script>

var canvas;
var ctx;
var walk_speed = 10;
var i = 0;
var x = 300;
var y = 300;
var keyPressed = {};
var ySprite = 0;



function draw() {
    var img = document.getElementById("background");
    ctx.drawImage(img, 0, 0, 340, 120, 0, 0, 340*3.8, 120*3.8);
    var sprite = document.getElementById('martian');
    ctx.drawImage(sprite,i*64,ySprite,64,64,x, y,75,75);
    requestAnimationFrame(draw);
    }
    


function update() {
    if ((keyPressed['Right']) || (keyPressed['ArrowRight'])) {
        i = (i+1)%4;
        x = x + walk_speed;
        ySprite = 128;
    }
    else if ((keyPressed['Left']) || (keyPressed['ArrowLeft'])) {
        i = (i+1)%4;
        x = x - walk_speed;
        //console.log("x = " +x);
        ySprite = 64;
    }
     else if ((keyPressed['Up']) || (keyPressed['ArrowUp'])) {
        i = (i+1)%4;
        y = y - walk_speed;
        //console.log("x = " +x);
        ySprite = 192;
    }
     else if ((keyPressed['Down']) || (keyPressed['ArrowDown'])) {
     	i = (i+1)%4;
        y = y + walk_speed;
        //console.log("x = " +x);
        ySprite = 0;
    }
}

function keydown(e) {
    keyPressed[e.key] = true;
}

function keyup(e) {
    keyPressed[e.key] = false;
    i = 0;
}

function init() {
    canvas = document.getElementById('myCanvas');
    ctx = canvas.getContext('2d');
    window.setInterval(update,50);
    requestAnimationFrame(draw);
    window.onkeydown = keydown;
    window.onkeyup = keyup;
}

window.onload = init;


</script>
</head>

<body>
<canvas id="myCanvas" width="640" height="447">
</canvas>
<img id="background" src="img/snow.png" style="display:none">
<img id="martian" src="img/martin.png" style="display:none">

</body>

</html>